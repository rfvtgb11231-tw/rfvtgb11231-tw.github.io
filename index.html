<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>犬、貓美容服務定型化契約</title>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  margin: 20px;
  line-height: 1.7;
}
h1 {
  margin-bottom: 10px;
}
#tabs {
  margin-bottom: 16px;
}
#tabs button {
  margin: 4px 4px 4px 0;
  padding: 6px 12px;
  border: 1px solid #ccc;
  background: #f5f5f5;
  cursor: pointer;
}
#tabs button.active {
  background: #333;
  color: #fff;
}
.section {
  margin-bottom: 20px;
}
.section h3 {
  margin-bottom: 6px;
}
</style>
</head>

<body>

<h1 id="contractTitle">載入中…</h1>
<div id="meta"></div>

<div id="tabs"></div>
<div id="content"></div>

<script>
let contractData;
let currentTab = 0;

fetch("contract.json")
  .then(res => res.json())
  .then(data => {
    contractData = data;
    document.getElementById("contractTitle").innerText = data.meta.name;
    document.getElementById("meta").innerText =
      "版本：" + data.meta.version + "｜來源：" + data.meta.source;
    renderTabs();
    renderContent();
  });

function renderTabs() {
  const tabsDiv = document.getElementById("tabs");
  tabsDiv.innerHTML = "";
  contractData.tabs.forEach((tab, index) => {
    const btn = document.createElement("button");
    btn.innerText = tab.title;
    btn.className = index === currentTab ? "active" : "";
    btn.onclick = () => {
      currentTab = index;
      renderTabs();
      renderContent();
    };
    tabsDiv.appendChild(btn);
  });
}

function renderContent() {
  const contentDiv = document.getElementById("content");
  contentDiv.innerHTML = "";
  const tab = contractData.tabs[currentTab];

  tab.sections.forEach(sec => {
    const sectionDiv = document.createElement("div");
    sectionDiv.className = "section";

    const h3 = document.createElement("h3");
    h3.innerText = sec.heading;
    sectionDiv.appendChild(h3);

    // 摘要（預設顯示）
    if (sec.summary) {
      const summary = document.createElement("p");
      summary.style.background = "#f7f7f7";
      summary.style.padding = "10px";
      summary.style.borderLeft = "4px solid #666";
      summary.innerText = "重點說明：" + sec.summary;
      sectionDiv.appendChild(summary);
    }

    // 展開按鈕
    const toggleBtn = document.createElement("button");
    toggleBtn.innerText = "展開政府公告全文";
    toggleBtn.style.marginBottom = "8px";

    const fullTextDiv = document.createElement("div");
    fullTextDiv.style.display = "none";

    sec.paragraphs.forEach(p => {
      const para = document.createElement("p");
      para.innerText = p;
      fullTextDiv.appendChild(para);
    });

    toggleBtn.onclick = () => {
      const isOpen = fullTextDiv.style.display === "block";
      fullTextDiv.style.display = isOpen ? "none" : "block";
      toggleBtn.innerText = isOpen ? "展開政府公告全文" : "收合政府公告全文";
    };

    sectionDiv.appendChild(toggleBtn);
    sectionDiv.appendChild(fullTextDiv);
    contentDiv.appendChild(sectionDiv);
  });
}
</script>

</body>
</html>
